{
  "meta": {
    "project": "MMW Hubix - School Information Portal",
    "date": "2025-11-14",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "MMW Hubix is a modern, centralized web portal designed for C.C.C. Mong Man Wai College to consolidate essential school information, resources, and tools for students, teachers, and IT administrators. It offers a public website with curated resource hubs, club announcements, and an AI assistant, alongside an internal IT Prefect system for team management, training, and event planning, with a comprehensive admin console for site and user management.",
  "core_goals": [
    "Provide a unified, modern platform replacing outdated IT Prefect sites",
    "Deliver a responsive, intuitive user experience across devices",
    "Securely manage user authentication, roles, and permissions with role-based access control",
    "Offer comprehensive public and internal content management capabilities",
    "Enable IT Prefect teams to manage schedules, trainings, tasks, and communications effectively",
    "Ensure site-wide settings are easily configurable with real-time updates",
    "Maintain high security standards including rate limiting, input sanitization, and logging",
    "Support extensible features including AI chat for user assistance"
  ],
  "key_features": [
    "Username-based authentication and session management with role-based access control (ADMIN, HELPER, STUDENT, GUEST)",
    "Public Resource Hub with dynamic categories, custom icons, colors, and real-time search",
    "Club Announcements with RSVP and attendance tracking via progress bars",
    "AI Assistant chatbot powered by OpenRouter with floating UI and rate limit handling",
    "IT Prefect Dashboard covering profile, team info, event calendar, training library, history timeline",
    "Admin Console for user management, resource category management, article CMS, and site system settings with real-time update and import/export",
    "Training Library with categorized videos and view tracking",
    "Internal and public event calendars with syncing from activities",
    "Media upload and playback support including video handling",
    "Comprehensive security features including security headers, rate limiting, input sanitization, and error logging",
    "Detailed database models with Prisma supporting relations between users, articles, resources, events, and settings"
  ],
  "user_flow_summary": [
    "Public users access the portal without login to browse resources, view announcements, and interact with the AI chat assistant",
    "IT Prefects authenticate via username or Google OAuth to access the dashboard with team information, event calendars, training, and profile management",
    "Admins log in to access the admin console for managing users, categories, articles, announcements, and system settings",
    "Users can update their own profiles and change passwords securely",
    "Admins perform batch user and category management including create, update, delete, and bulk operations with validation",
    "IT Prefects RSVP to club announcements and join activity events through interactive UI components",
    "Admins change system-wide settings with immediate effect and can export or import configuration backups"
  ],
  "validation_criteria": [
    "Authentication correctness with secure password change and session management",
    "Role and permission enforcement on protected API routes and pages",
    "CRUD operations on users, categories, articles, announcements, and settings are functional with validation",
    "Resource Hub supports real-time search and click tracking analytics",
    "AI chat handles rate limits gracefully with user notifications",
    "Event calendar syncing from activities updates internal and public calendars accurately",
    "Training library tracks resource views and categorizes content correctly",
    "System settings changes are applied immediately and persist with export/import",
    "Security features including rate limiting, CSP headers, and input sanitization are enforced",
    "Error logging captures client, server, and edge errors consistently",
    "Responsive design tested across desktop, tablet, and mobile devices",
    "UI animations and transitions perform smoothly and provide positive user feedback"
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript 5",
      "Next.js 15 (App Router)",
      "Tailwind CSS 4",
      "shadcn/ui",
      "Prisma (MySQL)",
      "NextAuth.js",
      "Zod",
      "Recharts",
      "Playwright"
    ],
    "features": [
      {
        "name": "Authentication",
        "description": "Username-based login with NextAuth.js and session provider integration.",
        "files": [
          "auth.ts",
          "app/api/auth/[...nextauth]/route.ts",
          "components/auth/simple-login-dialog.tsx",
          "components/auth/session-provider.tsx",
          "components/auth/user-menu.tsx",
          "app/unauthorized/page.tsx"
        ]
      },
      {
        "name": "Permissions & Roles",
        "description": "Server-side ABAC permissions and role enforcement across APIs and pages.",
        "files": [
          "lib/permissions.ts",
          "lib/permissions/abac.ts",
          "app/api/admin/users/route.ts",
          "middleware.ts"
        ]
      },
      {
        "name": "Settings Management",
        "description": "Site settings service with public and admin APIs and management UI.",
        "files": [
          "lib/settings-service.ts",
          "app/api/settings/route.ts",
          "app/api/admin/settings/route.ts",
          "app/admin/settings/page.tsx",
          "components/admin/system-settings.tsx"
        ]
      },
      {
        "name": "Announcements",
        "description": "Club announcements CRUD with public and authenticated endpoints.",
        "files": [
          "lib/repositories/announcement.repository.ts",
          "app/api/announcements/route.ts",
          "app/api/announcements/[id]/route.ts",
          "app/api/public/announcements/route.ts",
          "app/admin/announcements/page.tsx",
          "components/club-announcements.tsx"
        ]
      },
      {
        "name": "Articles CMS",
        "description": "Article creation, listing, and public rendering with slug routing.",
        "files": [
          "lib/repositories/article.repository.ts",
          "app/api/admin/articles/route.ts",
          "app/api/public/articles/route.ts",
          "app/articles/page.tsx",
          "app/articles/[slug]/page.tsx",
          "components/admin/article-management.tsx"
        ]
      },
      {
        "name": "Resources Hub",
        "description": "Curated external links with categories and admin management UI.",
        "files": [
          "lib/services/resource.service.ts",
          "lib/resources.ts",
          "app/api/resources/route.ts",
          "app/admin/resources/page.tsx",
          "components/resource-hub.tsx",
          "components/admin/resource-management.tsx"
        ]
      },
      {
        "name": "Activity News",
        "description": "Activity news listing, join endpoints, and admin management UI.",
        "files": [
          "lib/activity-news.ts",
          "app/api/activity-news/route.ts",
          "app/api/activity-news/[id]/route.ts",
          "app/api/activity-news/[id]/join/route.ts",
          "app/activity-news/page.tsx",
          "components/activity-news-public.tsx",
          "components/admin/activity-news-management.tsx"
        ]
      },
      {
        "name": "Dashboard",
        "description": "User dashboard with profile, team, history, training, and calendar.",
        "files": [
          "lib/dashboard-data.ts",
          "app/dashboard/page.tsx",
          "app/dashboard/profile/page.tsx",
          "app/dashboard/team/page.tsx",
          "app/dashboard/history/page.tsx",
          "app/dashboard/training/page.tsx",
          "components/dashboard/dashboard-layout.tsx",
          "components/dashboard/user-profile.tsx",
          "components/dashboard/team-information.tsx",
          "components/dashboard/it-perfect-history.tsx",
          "components/dashboard/training-library.tsx"
        ]
      },
      {
        "name": "Calendar",
        "description": "Internal and public calendars with admin syncing from activities.",
        "files": [
          "components/dashboard/internal-calendar.tsx",
          "app/dashboard/calendar/page.tsx",
          "app/api/admin/calendar/route.ts",
          "app/api/admin/calendar/[id]/route.ts",
          "app/api/admin/calendar/from-activity/route.ts"
        ]
      },
      {
        "name": "Training Library",
        "description": "Training resources with categories, views tracking, and admin endpoints.",
        "files": [
          "lib/training.ts",
          "app/api/training/route.ts",
          "app/api/training/[id]/route.ts",
          "app/api/training/[id]/views/route.ts",
          "app/api/training/categories/route.ts",
          "components/dashboard/training-library.tsx"
        ]
      },
      {
        "name": "Upload & Media",
        "description": "Media upload handling and video playback utilities.",
        "files": [
          "lib/video-storage.ts",
          "app/api/upload/route.ts",
          "components/video-player.tsx"
        ]
      },
      {
        "name": "AI Chat",
        "description": "OpenRouter-powered AI chat with UI widget and server proxy.",
        "files": [
          "app/api/chat/route.ts",
          "components/ai-chat.tsx",
          "components/ai-chat-widget.tsx"
        ]
      },
      {
        "name": "Security & Rate Limiting",
        "description": "Request sanitization, security headers, and rate-limit protections.",
        "files": [
          "lib/rate-limiter.ts",
          "lib/security/sanitizer.ts",
          "lib/security-headers.ts",
          "middleware.ts"
        ]
      },
      {
        "name": "Logging & Error Handling",
        "description": "Centralized logging and error handling for API routes.",
        "files": [
          "lib/logger.ts",
          "lib/logging/logger.ts",
          "lib/error-handler.ts",
          "components/error-boundary.tsx",
          "app/global-error.tsx"
        ]
      },
      {
        "name": "Browser Extension Cleanup",
        "description": "Mitigates layout interference from browser extensions.",
        "files": [
          "lib/browser-extension-cleanup.ts",
          "components/browser-extension-cleanup.tsx"
        ]
      },
      {
        "name": "Database Layer & Prisma",
        "description": "Prisma client, schema, repositories, and base database utilities.",
        "files": [
          "lib/prisma.ts",
          "prisma/schema.prisma",
          "lib/database.ts",
          "lib/repositories/base.repository.ts",
          "lib/repositories/user.repository.ts",
          "lib/repositories/category.repository.ts"
        ]
      },
      {
        "name": "Repositories & Services",
        "description": "Domain repositories and services for articles and resources.",
        "files": [
          "lib/repositories/article.repository.ts",
          "lib/repositories/resource.repository.ts",
          "lib/services/article.service.ts",
          "lib/services/resource.service.ts"
        ]
      },
      {
        "name": "UI Library",
        "description": "Reusable UI components built on shadcn/ui and Tailwind.",
        "files": [
          "components/ui/button.tsx",
          "components/ui/input.tsx",
          "components/ui/table.tsx",
          "components/ui/toaster.tsx",
          "components/theme-provider.tsx",
          "components/icons.tsx"
        ]
      },
      {
        "name": "Configuration",
        "description": "Site configuration and Next.js config settings.",
        "files": [
          "config/site.ts",
          "next.config.mjs",
          "eslint.config.js",
          "playwright.config.ts"
        ]
      }
    ]
  }
}
